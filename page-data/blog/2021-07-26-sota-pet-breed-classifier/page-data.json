{"componentChunkName":"component---src-components-jupyter-blog-layout-js","path":"/blog/2021-07-26-sota-pet-breed-classifier/","result":{"data":{"jupyterNotebook":{"id":"82d687fe-9fbe-5334-a4bf-5373028f2c62 >>> JupyterNotebook","html":"<div class=\"notebook-render\"><div class=\"sc-ifAKCX zMCZx\"><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><h1>Building a State-of-the-Art Pet Breed Classifier Without Breaking a Sweat</h1>\n<p><a href=\"https://github.com/fastai/fastbook/blob/master/05_pet_breeds.ipynb\">Chapter 5 of Fastbook</a> contains very helpful tips on how to achieve world-class results with deep learning. In this post, we&#x27;ll use those tips to build a state-of-the-art pet breed classifier.</p>\n<p>In particular, we will look at the following techniques:</p>\n<ul>\n<li>Presizing during data augmentation</li>\n<li>Using transfer learning with pre-trained models</li>\n<li>Finding the best learning rate</li>\n<li>Using discriminative learning rates</li>\n<li>Training for the right number of epochs</li>\n<li>Experimenting with deeper architectures</li>\n</ul>\n<p>First, let us download and extract the data.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">from</span><span> fastai</span><span class=\"token\" style=\"color:#393A34\">.</span><span>vision</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">all</span><span> </span><span class=\"token\" style=\"color:#0000ff\">import</span><span> </span><span class=\"token\" style=\"color:#393A34\">*</span><span>\n</span>\n<span>path </span><span class=\"token\" style=\"color:#393A34\">=</span><span> untar_data</span><span class=\"token\" style=\"color:#393A34\">(</span><span>URLs</span><span class=\"token\" style=\"color:#393A34\">.</span><span>PETS</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#393A34\">(</span><span>path</span><span class=\"token\" style=\"color:#393A34\">/</span><span class=\"token\" style=\"color:#A31515\">&#x27;images&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span>ls</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs fWFfJb nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>(#7393) [Path(&#x27;/root/.fastai/data/oxford-iiit-pet/images/Russian_Blue_28.jpg&#x27;),Path(&#x27;/root/.fastai/data/oxford-iiit-pet/images/Ragdoll_18.jpg&#x27;),Path(&#x27;/root/.fastai/data/oxford-iiit-pet/images/boxer_175.jpg&#x27;),Path(&#x27;/root/.fastai/data/oxford-iiit-pet/images/german_shorthaired_9.jpg&#x27;),Path(&#x27;/root/.fastai/data/oxford-iiit-pet/images/saint_bernard_28.jpg&#x27;),Path(&#x27;/root/.fastai/data/oxford-iiit-pet/images/staffordshire_bull_terrier_39.jpg&#x27;),Path(&#x27;/root/.fastai/data/oxford-iiit-pet/images/boxer_36.jpg&#x27;),Path(&#x27;/root/.fastai/data/oxford-iiit-pet/images/Bengal_179.jpg&#x27;),Path(&#x27;/root/.fastai/data/oxford-iiit-pet/images/Birman_118.jpg&#x27;),Path(&#x27;/root/.fastai/data/oxford-iiit-pet/images/scottish_terrier_153.jpg&#x27;)...]</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p>The <code>images</code> folder contains all the images we are interested in. The file name of the images also contains the name of the breed. We can extract these labels from the file name using a regular expression in our data block.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span>pets </span><span class=\"token\" style=\"color:#393A34\">=</span><span> DataBlock</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>    blocks </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">(</span><span>ImageBlock</span><span class=\"token\" style=\"color:#393A34\">,</span><span> CategoryBlock</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    get_items </span><span class=\"token\" style=\"color:#393A34\">=</span><span> get_image_files</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    splitter </span><span class=\"token\" style=\"color:#393A34\">=</span><span> RandomSplitter</span><span class=\"token\" style=\"color:#393A34\">(</span><span>seed</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">42</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    get_y </span><span class=\"token\" style=\"color:#393A34\">=</span><span> using_attr</span><span class=\"token\" style=\"color:#393A34\">(</span><span>RegexLabeller</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">r&#x27;(.+)_\\d+.jpg&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;name&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    item_tfms</span><span class=\"token\" style=\"color:#393A34\">=</span><span>Resize</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">460</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    batch_tfms </span><span class=\"token\" style=\"color:#393A34\">=</span><span> aug_transforms</span><span class=\"token\" style=\"color:#393A34\">(</span><span>size</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">224</span><span class=\"token\" style=\"color:#393A34\">,</span><span> min_scale</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0.75</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span></span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p>There are two transforms that have been used in the data block: one for each item, and another for each batch.</p>\n<p>First, each image is resized to <code>460x460</code>. This is much larger than the size that we will feed to our model.</p>\n<p>When images are then batched, augmentations are applied on the GPU for the entire batch and in the last step of this augmentation, the images are resized to <code>224x224</code>.</p>\n<p>This approach is known as <strong>presizing</strong> and it helps greatly reduce the amount of empty zones and degraded data that would otherwise occur if we resize the images directly to <code>224x224</code> and perform augmentations on them.</p>\n<p>Before we move on, let us check if we have set everything up correctly.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span>pets</span><span class=\"token\" style=\"color:#393A34\">.</span><span>summary</span><span class=\"token\" style=\"color:#393A34\">(</span><span>path</span><span class=\"token\" style=\"color:#393A34\">/</span><span class=\"token\" style=\"color:#A31515\">&#x27;images&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs fWFfJb nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><code class=\"nteract-display-area-stdout\"><span>Setting-up type transforms pipelines\nCollecting items from /root/.fastai/data/oxford-iiit-pet/images\nFound 7390 items\n2 datasets of sizes 5912,1478\nSetting up Pipeline: PILBase.create\nSetting up Pipeline: partial -&gt; Categorize -- {&#x27;vocab&#x27;: None, &#x27;sort&#x27;: True, &#x27;add_na&#x27;: False}\n\nBuilding one sample\n  Pipeline: PILBase.create\n    starting from\n      /root/.fastai/data/oxford-iiit-pet/images/english_cocker_spaniel_199.jpg\n    applying PILBase.create gives\n      PILImage mode=RGB size=500x281\n  Pipeline: partial -&gt; Categorize -- {&#x27;vocab&#x27;: None, &#x27;sort&#x27;: True, &#x27;add_na&#x27;: False}\n    starting from\n      /root/.fastai/data/oxford-iiit-pet/images/english_cocker_spaniel_199.jpg\n    applying partial gives\n      english_cocker_spaniel\n    applying Categorize -- {&#x27;vocab&#x27;: None, &#x27;sort&#x27;: True, &#x27;add_na&#x27;: False} gives\n      TensorCategory(18)\n\nFinal sample: (PILImage mode=RGB size=500x281, TensorCategory(18))\n\n\nCollecting items from /root/.fastai/data/oxford-iiit-pet/images\nFound 7390 items\n2 datasets of sizes 5912,1478\nSetting up Pipeline: PILBase.create\nSetting up Pipeline: partial -&gt; Categorize -- {&#x27;vocab&#x27;: None, &#x27;sort&#x27;: True, &#x27;add_na&#x27;: False}\nSetting up after_item: Pipeline: Resize -- {&#x27;size&#x27;: (460, 460), &#x27;method&#x27;: &#x27;crop&#x27;, &#x27;pad_mode&#x27;: &#x27;reflection&#x27;, &#x27;resamples&#x27;: (2, 0), &#x27;p&#x27;: 1.0} -&gt; ToTensor\nSetting up before_batch: Pipeline: \nSetting up after_batch: Pipeline: IntToFloatTensor -- {&#x27;div&#x27;: 255.0, &#x27;div_mask&#x27;: 1} -&gt; Flip -- {&#x27;size&#x27;: None, &#x27;mode&#x27;: &#x27;bilinear&#x27;, &#x27;pad_mode&#x27;: &#x27;reflection&#x27;, &#x27;mode_mask&#x27;: &#x27;nearest&#x27;, &#x27;align_corners&#x27;: True, &#x27;p&#x27;: 0.5} -&gt; RandomResizedCropGPU -- {&#x27;size&#x27;: (224, 224), &#x27;min_scale&#x27;: 0.75, &#x27;ratio&#x27;: (1, 1), &#x27;mode&#x27;: &#x27;bilinear&#x27;, &#x27;valid_scale&#x27;: 1.0, &#x27;max_scale&#x27;: 1.0, &#x27;p&#x27;: 1.0} -&gt; Brightness -- {&#x27;max_lighting&#x27;: 0.2, &#x27;p&#x27;: 1.0, &#x27;draw&#x27;: None, &#x27;batch&#x27;: False}\n\nBuilding one batch\nApplying item_tfms to the first sample:\n  Pipeline: Resize -- {&#x27;size&#x27;: (460, 460), &#x27;method&#x27;: &#x27;crop&#x27;, &#x27;pad_mode&#x27;: &#x27;reflection&#x27;, &#x27;resamples&#x27;: (2, 0), &#x27;p&#x27;: 1.0} -&gt; ToTensor\n    starting from\n      (PILImage mode=RGB size=500x281, TensorCategory(18))\n    applying Resize -- {&#x27;size&#x27;: (460, 460), &#x27;method&#x27;: &#x27;crop&#x27;, &#x27;pad_mode&#x27;: &#x27;reflection&#x27;, &#x27;resamples&#x27;: (2, 0), &#x27;p&#x27;: 1.0} gives\n      (PILImage mode=RGB size=460x460, TensorCategory(18))\n    applying ToTensor gives\n      (TensorImage of size 3x460x460, TensorCategory(18))\n\nAdding the next 3 samples\n\nNo before_batch transform to apply\n\nCollating items in a batch\n\nApplying batch_tfms to the batch built\n  Pipeline: IntToFloatTensor -- {&#x27;div&#x27;: 255.0, &#x27;div_mask&#x27;: 1} -&gt; Flip -- {&#x27;size&#x27;: None, &#x27;mode&#x27;: &#x27;bilinear&#x27;, &#x27;pad_mode&#x27;: &#x27;reflection&#x27;, &#x27;mode_mask&#x27;: &#x27;nearest&#x27;, &#x27;align_corners&#x27;: True, &#x27;p&#x27;: 0.5} -&gt; RandomResizedCropGPU -- {&#x27;size&#x27;: (224, 224), &#x27;min_scale&#x27;: 0.75, &#x27;ratio&#x27;: (1, 1), &#x27;mode&#x27;: &#x27;bilinear&#x27;, &#x27;valid_scale&#x27;: 1.0, &#x27;max_scale&#x27;: 1.0, &#x27;p&#x27;: 1.0} -&gt; Brightness -- {&#x27;max_lighting&#x27;: 0.2, &#x27;p&#x27;: 1.0, &#x27;draw&#x27;: None, &#x27;batch&#x27;: False}\n    starting from\n      (TensorImage of size 4x3x460x460, TensorCategory([18,  5,  5,  0], device=&#x27;cuda:0&#x27;))\n    applying IntToFloatTensor -- {&#x27;div&#x27;: 255.0, &#x27;div_mask&#x27;: 1} gives\n      (TensorImage of size 4x3x460x460, TensorCategory([18,  5,  5,  0], device=&#x27;cuda:0&#x27;))\n    applying Flip -- {&#x27;size&#x27;: None, &#x27;mode&#x27;: &#x27;bilinear&#x27;, &#x27;pad_mode&#x27;: &#x27;reflection&#x27;, &#x27;mode_mask&#x27;: &#x27;nearest&#x27;, &#x27;align_corners&#x27;: True, &#x27;p&#x27;: 0.5} gives\n      (TensorImage of size 4x3x460x460, TensorCategory([18,  5,  5,  0], device=&#x27;cuda:0&#x27;))\n    applying RandomResizedCropGPU -- {&#x27;size&#x27;: (224, 224), &#x27;min_scale&#x27;: 0.75, &#x27;ratio&#x27;: (1, 1), &#x27;mode&#x27;: &#x27;bilinear&#x27;, &#x27;valid_scale&#x27;: 1.0, &#x27;max_scale&#x27;: 1.0, &#x27;p&#x27;: 1.0} gives\n      (TensorImage of size 4x3x224x224, TensorCategory([18,  5,  5,  0], device=&#x27;cuda:0&#x27;))\n    applying Brightness -- {&#x27;max_lighting&#x27;: 0.2, &#x27;p&#x27;: 1.0, &#x27;draw&#x27;: None, &#x27;batch&#x27;: False} gives\n      (TensorImage of size 4x3x224x224, TensorCategory([18,  5,  5,  0], device=&#x27;cuda:0&#x27;))\n</span></code></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p>Looks good! We can now create DataLoaders from this data block.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span>dls </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pets</span><span class=\"token\" style=\"color:#393A34\">.</span><span>dataloaders</span><span class=\"token\" style=\"color:#393A34\">(</span><span>path</span><span class=\"token\" style=\"color:#393A34\">/</span><span class=\"token\" style=\"color:#A31515\">&#x27;images&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p>Instead of training a model from scratch, we use <strong>transfer learning</strong>. This is where we take a model that is trained for another task or a different dataset, and fine-tune its parameters for the task we are interested in.</p>\n<p>Let us start with a <code>resnet50</code> model trained on the ImageNet dataset.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span>learn </span><span class=\"token\" style=\"color:#393A34\">=</span><span> cnn_learner</span><span class=\"token\" style=\"color:#393A34\">(</span><span>dls</span><span class=\"token\" style=\"color:#393A34\">,</span><span> resnet50</span><span class=\"token\" style=\"color:#393A34\">,</span><span> metrics</span><span class=\"token\" style=\"color:#393A34\">=</span><span>error_rate</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p>Under the hood, the final layer of the network is discarded because the number of outputs it has depends on the task it was trained for - in this case, classification on the ImageNet dataset. A new layer that contains the correct number of outputs required for our task is then attached to the model.</p>\n<p>Before we start training this model on our dataset, we need to decide the learning rate to use. The learning rate determines how efficiently a model is trained. Using a small learning rate requires the model to be trained for more epochs. On the other hand, using a large learning rate may prevent the loss from settling at a minimum. With a large enough learning rate, the loss may even begin to diverge.</p>\n<p>In 2015, Leslie Smith published a <a href=\"https://arxiv.org/abs/1506.01186\">paper</a> where he came up with the idea of a <strong>learning rate finder</strong> - a method to find the ideal learning rate.</p>\n<p>The process works as follows:</p>\n<ol>\n<li>Set the learning rate to an extremely small value.</li>\n<li>Increase the learning rate by a certain percentage for each mini-batch (e.g. double the learning rate for each mini-batch) and record the loss value.</li>\n<li>Keep repeating this process until the loss gets worse instead of getting better.</li>\n</ol>\n<p>Fastai has this procedure available in the <code>lr_find</code> method.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span>\n</span><span>lr_min</span><span class=\"token\" style=\"color:#393A34\">,</span><span> lr_steep</span><span class=\"token\" style=\"color:#393A34\">,</span><span> lr_valley</span><span class=\"token\" style=\"color:#393A34\">,</span><span> lr_slide </span><span class=\"token\" style=\"color:#393A34\">=</span><span> learn</span><span class=\"token\" style=\"color:#393A34\">.</span><span>lr_find</span><span class=\"token\" style=\"color:#393A34\">(</span><span>suggest_funcs</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">(</span><span>minimum</span><span class=\"token\" style=\"color:#393A34\">,</span><span> steep</span><span class=\"token\" style=\"color:#393A34\">,</span><span> valley</span><span class=\"token\" style=\"color:#393A34\">,</span><span> slide</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs fWFfJb nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><div></div><img alt=\"\" src=\"data:image/png;base64,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\" class=\"sc-bdVaJa jFcqvn\"/></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span>lr_min</span><span class=\"token\" style=\"color:#393A34\">,</span><span> lr_steep</span><span class=\"token\" style=\"color:#393A34\">,</span><span> lr_valley</span><span class=\"token\" style=\"color:#393A34\">,</span><span> lr_slide</span></code></pre></div><div class=\"sc-htoDjs fWFfJb nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>(0.006918309628963471,\n 0.0008317637839354575,\n 0.0003311311302240938,\n 0.0004786300996784121)</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p>Using the learning rate finder, we&#x27;ve asked fastai to suggest 4 different learning rates:</p>\n<ol>\n<li>minimum - one-tenth the value of the learning rate where the loss is minimum.</li>\n<li>steep - learning rate at which the slope of the loss is steepest.</li>\n<li>valley - the steepest slope roughly 2/3 through the longest valley.</li>\n<li>slide - learning rate following an interval slide rule.</li>\n</ol>\n<p>More details about these methods can be found in the <a href=\"https://docs.fast.ai/callback.schedule.html#Suggestion-Methods\">fastai documentation</a>.</p>\n<p>Let us train the new head for a few epochs using the learning rate at the steepest slope</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span>learn</span><span class=\"token\" style=\"color:#393A34\">.</span><span>fit_one_cycle</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">5</span><span class=\"token\" style=\"color:#393A34\">,</span><span> lr_steep</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs fWFfJb nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><div><table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: left;\">\n      <th>epoch</th>\n      <th>train_loss</th>\n      <th>valid_loss</th>\n      <th>error_rate</th>\n      <th>time</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>0</td>\n      <td>1.317904</td>\n      <td>0.266430</td>\n      <td>0.083221</td>\n      <td>01:16</td>\n    </tr>\n    <tr>\n      <td>1</td>\n      <td>0.525201</td>\n      <td>0.243140</td>\n      <td>0.070365</td>\n      <td>01:15</td>\n    </tr>\n    <tr>\n      <td>2</td>\n      <td>0.324229</td>\n      <td>0.210824</td>\n      <td>0.059540</td>\n      <td>01:16</td>\n    </tr>\n    <tr>\n      <td>3</td>\n      <td>0.211695</td>\n      <td>0.175427</td>\n      <td>0.049391</td>\n      <td>01:16</td>\n    </tr>\n    <tr>\n      <td>4</td>\n      <td>0.181848</td>\n      <td>0.177565</td>\n      <td>0.048714</td>\n      <td>01:17</td>\n    </tr>\n  </tbody>\n</table></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p>The newly attached &quot;head&quot; of the model has completely random weights. If we try to train the entire model then we will destroy the perfectly well-trained parameters in the earlier layers of the model. To prevent this, we first trained only the parameters of the newly added layer with all earlier layers frozen.</p>\n<p>Now we are ready to unfreeze the pre-trained layers and train all the layers in the model.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span>learn</span><span class=\"token\" style=\"color:#393A34\">.</span><span>unfreeze</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p>The earlier layers of a model may not need as high a learning rate as the later layers, especially the newly added final layer. Using a high learning rate for the earlier layers may still destroy the parameters that have been learning by training for many epochs on enormous datasets.</p>\n<p>A Python <code>slice</code> object can be passed anywhere a learning rate is expected in fastai. The first value will be the learning rate of the earliest layer, the second will be the learning rate of the final layer. The layers in between will have learning rates that are multiplicatively equidistant throughout the range.</p>\n<p>But first, since we&#x27;ve unfrozen layers and there are more parameters to train, let&#x27;s run the learning rate finder again to find the best learning rate.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span>lr_min</span><span class=\"token\" style=\"color:#393A34\">,</span><span> lr_steep</span><span class=\"token\" style=\"color:#393A34\">,</span><span> lr_valley</span><span class=\"token\" style=\"color:#393A34\">,</span><span> lr_slide </span><span class=\"token\" style=\"color:#393A34\">=</span><span> learn</span><span class=\"token\" style=\"color:#393A34\">.</span><span>lr_find</span><span class=\"token\" style=\"color:#393A34\">(</span><span>suggest_funcs</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">(</span><span>minimum</span><span class=\"token\" style=\"color:#393A34\">,</span><span> steep</span><span class=\"token\" style=\"color:#393A34\">,</span><span> valley</span><span class=\"token\" style=\"color:#393A34\">,</span><span> slide</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs fWFfJb nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><div></div><img alt=\"\" src=\"data:image/png;base64,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\" class=\"sc-bdVaJa jFcqvn\"/></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span>lr_min</span><span class=\"token\" style=\"color:#393A34\">,</span><span> lr_steep</span><span class=\"token\" style=\"color:#393A34\">,</span><span> lr_valley</span><span class=\"token\" style=\"color:#393A34\">,</span><span> lr_slide</span></code></pre></div><div class=\"sc-htoDjs fWFfJb nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><pre><code><span>(3.0199516913853586e-06,\n 6.309573450380412e-07,\n 9.999999747378752e-06,\n 3.630780702224001e-05)</span></code></pre></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p>The graph looks much different from the first time we ran the test because the head of our model has been fine-tuned already.</p>\n<p>We can now use <code>lr_steep</code> for the earliest layer and <code>lr_valley</code> for the last layer.</p>\n<p>In general, you should use a learning rate before the sharp increase in the loss.</p></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-gzVnrw iiEGBE input-container\"><pre class=\"sc-bZQynM dQAqiJ input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span>learn</span><span class=\"token\" style=\"color:#393A34\">.</span><span>fit_one_cycle</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">,</span><span> lr_max</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token builtin\">slice</span><span class=\"token\" style=\"color:#393A34\">(</span><span>lr_steep</span><span class=\"token\" style=\"color:#393A34\">,</span><span> lr_valley</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-htoDjs fWFfJb nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><div><table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: left;\">\n      <th>epoch</th>\n      <th>train_loss</th>\n      <th>valid_loss</th>\n      <th>error_rate</th>\n      <th>time</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>0</td>\n      <td>0.149643</td>\n      <td>0.175833</td>\n      <td>0.047361</td>\n      <td>01:31</td>\n    </tr>\n    <tr>\n      <td>1</td>\n      <td>0.162749</td>\n      <td>0.176478</td>\n      <td>0.049391</td>\n      <td>01:30</td>\n    </tr>\n    <tr>\n      <td>2</td>\n      <td>0.152322</td>\n      <td>0.178343</td>\n      <td>0.048714</td>\n      <td>01:31</td>\n    </tr>\n    <tr>\n      <td>3</td>\n      <td>0.143987</td>\n      <td>0.170578</td>\n      <td>0.046008</td>\n      <td>01:32</td>\n    </tr>\n    <tr>\n      <td>4</td>\n      <td>0.138569</td>\n      <td>0.167886</td>\n      <td>0.043978</td>\n      <td>01:31</td>\n    </tr>\n    <tr>\n      <td>5</td>\n      <td>0.142414</td>\n      <td>0.171065</td>\n      <td>0.046008</td>\n      <td>01:31</td>\n    </tr>\n    <tr>\n      <td>6</td>\n      <td>0.128563</td>\n      <td>0.166929</td>\n      <td>0.044655</td>\n      <td>01:31</td>\n    </tr>\n    <tr>\n      <td>7</td>\n      <td>0.130237</td>\n      <td>0.168690</td>\n      <td>0.043302</td>\n      <td>01:32</td>\n    </tr>\n    <tr>\n      <td>8</td>\n      <td>0.128327</td>\n      <td>0.169738</td>\n      <td>0.043978</td>\n      <td>01:31</td>\n    </tr>\n    <tr>\n      <td>9</td>\n      <td>0.122282</td>\n      <td>0.168022</td>\n      <td>0.045332</td>\n      <td>01:31</td>\n    </tr>\n  </tbody>\n</table></div></div></div></div><div class=\"sc-bxivhb HLmih cell\" style=\"box-shadow:none\"><div class=\"sc-iwsKbI exQuEV markdown\"><p>The number of epochs I have trained for was not a random choice. I actually trained the model for many more epochs and saw when the <code>error_rate</code> started increasing. Then I retrained the model for just those many epochs.</p>\n<p>In general, you need to stop training when the metrics you are interested in started getting worse, and not the loss function. The loss function is there just to allow the optimizer to differentiate and update the parameters of the model. It&#x27;s the metrics that we really care about.</p>\n<p>Also, the pre-trained model I selected was <code>resnet50</code>. You can also experiment with shallower or deeper models. Models with more layers can capture more complex relationships in data. However, they can also memorize the data more easily and start overfitting.</p>\n<p>Further, when the number of layers in a model is increased, the batch size may need to be reduced to keep the GPU from running out of memory.</p>\n<p>Deeper models also take much longer to train. However, training can be sped up using half-precision floating point numbers.</p>\n<h2>Conclusion</h2>\n<p>In this short post, we achieved state-of-the-art classification accuracy without breaking a sweat! According to the <a href=\"https://paperswithcode.com/sota/fine-grained-image-classification-on-oxford-1\">Papers with Code page</a> of this dataset, our model would be in the top 10! (Place 6 to be precise, at the time of writing this post).</p>\n<p>The concepts covered in chapter 5 of fastbook and in this post can be reused for other datasets and tasks as well.</p>\n<p>To summarize,</p>\n<ul>\n<li>Use presizing to reduce the amount of data degradation during augmentation of image datasets</li>\n<li>Start with pre-trained models instead of training from scratch</li>\n<li>Use the learning rate finder to get the best learning rate (when pre-trained weights are frozen AND after unfreezing all layers)</li>\n<li>Use a lower learning rate for earlier layers of the model and a higher one for later layers (discriminative learning rates)</li>\n<li>Select the right number of epochs to train for</li>\n<li>Experiment with deeper architectures, but keep in mind they&#x27;re not always better.</li>\n</ul></div></div></div></div>","json":{"metadata":{"title":"Building a State-of-the-Art Pet Breed Classifier Without Breaking a Sweat","date":"2021-07-26"}}}},"pageContext":{"id":"82d687fe-9fbe-5334-a4bf-5373028f2c62 >>> JupyterNotebook"}},"staticQueryHashes":["3069025275","63159454"]}