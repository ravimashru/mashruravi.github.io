<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.1db540ecee05b1203c9d.css" id="gatsby-global-css">@import url(https://fonts.googleapis.com/css?family=Raleway|Roboto&display=swap);@font-face{font-family:Socialico;src:url(/static/Socialico-Regular-1fd9a7b1ba4a914c010b8a8ff0636c61.woff)}@font-face{font-family:SocialicoPlus;src:url(/static/SocialicoPlus-Plus-36c8776ee66b40b4175cfc1bb94e275f.woff)}body{margin:0;-moz-osx-font-smoothing:grayscale;font-family:Roboto,Helvetica,Arial,sans-serif;-webkit-font-smoothing:antialiased}header{height:48px;display:flex;justify-content:center;align-items:center;padding:0 16px;background-color:rgba(0,0,0,.8);-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px);transition:background-color .5s}header.expanded{background-color:#000}.hdr-normal{display:block}.hdr-col{display:none}.header-link{color:#fff;text-decoration:none;font-family:Raleway;margin:0 18px;padding:8px 16px;border-radius:10px}.prf-hdr-grid-ctr{display:flex}.prf-hdr-ctr{color:#6c6c6c;font-size:36px;margin:36px auto;display:grid;grid-template-columns:minmax(250px,25%) auto}.prf-hdr-intro>div{line-height:36px;margin-bottom:16px;margin-top:16px}.prf-hdr-intro strong{color:#19b6ff}.prf-hdr-img{margin:auto;grid-row-start:1;grid-row-end:3}.prf-hdr-social{display:flex}.hdr-col-menu{width:50px;height:40px;position:relative;cursor:pointer}.hdr-col-menu-bar{position:absolute;height:1px;background-color:#fff;left:12px;right:12px}.hdr-col-menu-bar-1{top:14px;transition:top .25s ease-out .15s,transform .15s ease-out}.hdr-col-menu-bar-2{bottom:14px;transition:bottom .25s ease-out .15s,transform .15s ease-out}.hdr-col-menu-bar-1-open{top:19px;transform:rotate(45deg);transition:top .15s ease-out,transform .25s ease-out .15s}.hdr-col-menu-bar-2-open{bottom:19px;transform:rotate(-45deg);transition:bottom .15s ease-out,transform .25s ease-out .15s}.hdr-col-itm-ctr{background-color:#000;position:absolute;left:0;right:0;top:48px;height:0;transition:.35s ease-out;overflow:hidden}.hdr-col-itm-ctr-exp{height:calc(100vh - 48px)}.hdr-col-itm-ctr-inner{display:flex;flex-direction:column;align-items:center;opacity:0;transition:opacity .25s ease-out .1s}.hdr-col-itm-ctr-inner-exp{opacity:1}.header-link-col{font-size:36px;height:48px;text-decoration:none;margin:16px 0;display:flex;align-items:center;color:#fff;padding:8px 24px;border-radius:10px}.section-container{margin:16px 64px;padding:32px 0}.section-header{color:#6c6c6c;font-size:32px;font-weight:700;text-align:center;margin:16px 0}.section-body{display:flex;flex-wrap:wrap;justify-content:center;margin:0 auto}.tech-item{display:flex;flex-direction:column;justify-content:flex-start;align-items:center;box-sizing:border-box;padding:16px;width:180px}.tech-item>img{height:60px}.tech-item>span{color:#6c6c6c;margin:8px 0}.proj-item{width:500px;height:380px;box-shadow:0 0 8px 0 rgba(0,0,0,.2),0 0 50px 0 rgba(0,0,0,.09);margin:24px;color:#6c6c6c;display:flex;flex-direction:column;box-sizing:border-box;position:relative;cursor:pointer;transition:box-shadow .2s ease-out}.proj-item:hover{box-shadow:0 0 16px 0 rgba(0,0,0,.2),0 0 50px 0 rgba(0,0,0,.09)}.proj-item:hover .proj-item-overlay{opacity:1}.proj-item-image,.proj-item-image-ctr{width:100%;height:100%}.proj-item-image{-o-object-fit:cover;object-fit:cover}.proj-item-overlay{opacity:0;padding:16px;position:absolute;background-color:rgba(0,0,0,.8);color:#fff;top:0;bottom:0;left:0;right:0;transition:opacity .5s}.proj-item-title{font-size:24px;font-weight:700;margin:24px 0;text-align:center}.proj-item-desc{font-size:24px;margin:0 16px;text-align:center}.proj-item-spacer{margin:auto}footer{padding:48px 16px}.blog-header{color:#6c6c6c;font-size:36px;text-align:center}.blog-list{max-width:650px;margin:0 auto;padding:0 16px}.blog-list-item{display:flex;flex-direction:column;margin:24px 0;padding:16px;color:#6c6c6c;text-decoration:none;transition:color .15s linear,border .15s linear;font-size:18px;box-sizing:border-box;border:1px solid transparent}.blog-list-item span:nth-child(2){font-size:12px}.blog-list-item:hover{color:#0c0c0c;border:1px solid rgba(0,0,0,.3)}.blog-content{padding:0 16px;max-width:800px;margin:0 auto;line-height:1.5;font-family:-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Arial,sans-serif}.blog-content blockquote{background:rgba(0,0,0,.03);padding:8px 32px;white-space:break-spaces;word-wrap:break-word}.blog-content h1{color:#6c6c6c}.blog-body{margin-bottom:36px;text-align:justify}.blog-body code{background-color:#d3d3d3;padding:4px 6px}.blog-body pre{background:#d3d3d3;padding:24px 12px;overflow:scroll;font-size:1.2rem}.blog-body pre code{padding:0}@media only screen and (max-width:750px){.prf-hdr-ctr{grid-template-columns:100%;font-size:24px;margin:16px;text-align:center;width:100%}.prf-hdr-intro>div{line-height:24px;margin-bottom:16px}.prf-hdr-img{margin:24px auto}.prf-hdr-social{margin:0 auto}.hdr-normal{display:none}header{justify-content:flex-end}.hdr-col{display:block}.section-container{margin:64px 8px;padding:0}.tech-item{width:110px}.tech-item>img{height:36px}.tech-item>span{text-align:center}.proj-item{width:300px;height:220px;margin:24px}.proj-item-title{font-size:22px;margin:24px 0;text-align:center}.proj-item-desc{font-size:16px}footer{padding:24px 8px}.blog-header{text-align:left;padding:0 16px}.blog-content h1{text-align:center}}@media only screen and (min-width:751px) and (max-width:900px){.prf-hdr-ctr{font-size:26px}.section-container{margin:32px 16px}.proj-item{width:300px;height:220px;margin:24px}.proj-item-title{font-size:22px;margin:24px 0;text-align:center}.proj-item-desc{font-size:16px}footer{padding:48px 16px}.blog-header{text-align:center}}.social-icon{margin:0 8px;font-size:64px}.social-icon>a{text-decoration:none;color:#6c6c6c;transition:.15s linear}.si{font-family:Socialico}.sip{font-family:SocialicoPlus}.si-linkedin>a:hover{color:#0077b5}.si-twitter>a:hover{color:#1ea1f2}.si-mail>a:hover{color:red}.si-github>a:hover{color:#000}</style><meta name="generator" content="Gatsby 2.31.1"/><title data-react-helmet="true">Reading Notes - Ch. 2 - Fastbook - Blog - Ravi Mashru</title><meta data-react-helmet="true" name="description" content="Ravi Mashru&#x27;s home page on the internet - personal portfolio, blog and notes."/><meta data-react-helmet="true" property="og:title" content="Reading Notes - Ch. 2 - Fastbook - Blog"/><meta data-react-helmet="true" property="og:description" content="Ravi Mashru&#x27;s home page on the internet - personal portfolio, blog and notes."/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="@mashruravi"/><meta data-react-helmet="true" name="twitter:title" content="Reading Notes - Ch. 2 - Fastbook - Blog"/><meta data-react-helmet="true" name="twitter:description" content="Ravi Mashru&#x27;s home page on the internet - personal portfolio, blog and notes."/><link rel="icon" href="/favicon-32x32.png?v=86476019a66cd05dc3116d3ffde5ff93" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#323232"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=86476019a66cd05dc3116d3ffde5ff93"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=86476019a66cd05dc3116d3ffde5ff93"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=86476019a66cd05dc3116d3ffde5ff93"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=86476019a66cd05dc3116d3ffde5ff93"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=86476019a66cd05dc3116d3ffde5ff93"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=86476019a66cd05dc3116d3ffde5ff93"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=86476019a66cd05dc3116d3ffde5ff93"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=86476019a66cd05dc3116d3ffde5ff93"/><link as="script" rel="preload" href="/webpack-runtime-67cc6cd1aab21bf7259a.js"/><link as="script" rel="preload" href="/framework-741ade27086b2708e961.js"/><link as="script" rel="preload" href="/app-4bb33029cc1bf54f0b6b.js"/><link as="script" rel="preload" href="/styles-e9d24b1846c7d6eb9685.js"/><link as="script" rel="preload" href="/commons-69d67839b5d44cb35357.js"/><link as="script" rel="preload" href="/component---src-components-blog-layout-js-88c55709438fb4ec120a.js"/><link as="fetch" rel="preload" href="/page-data/blog/2021-06-30-fastbook-ch2/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3069025275.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/63159454.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div style="position:fixed;top:0;left:0;right:0;z-index:1"><header class=""><div class="hdr-normal"><a class="header-link" href="/">Home</a><a class="header-link" href="/blog/">Blog</a><a class="header-link" href="https://github.com/mashruravi/notes" target="_blank" rel="noopener noreferrer">Notes</a></div><div class="hdr-col"><div class="hdr-col-menu"><div class="hdr-col-menu-bar hdr-col-menu-bar-1"></div><div class="hdr-col-menu-bar hdr-col-menu-bar-2"></div></div><div class="hdr-col-itm-ctr "><div class="hdr-col-itm-ctr-inner "><a class="header-link-col" href="/">Home</a><a class="header-link-col" href="/blog/">Blog</a><a class="header-link-col" href="https://github.com/mashruravi/notes" target="_blank" rel="noopener noreferrer">Notes</a></div></div></div></header></div><main style="padding-top:98px;min-width:350px;margin:auto;min-height:calc(100vh - 98px - 50px)"><div class="blog-content"><h1>Reading Notes - Ch. 2 - Fastbook</h1><div class="blog-body"><main><h2>First, some advice...</h2><blockquote><p>Underestimating the constraints and overestimating the capabilities of deep learning may lead to frustratingly poor results. Conversely, overestimating the constraints and underestimating the capabilities of deep learning may mean you do not attempt a solvable problem because you talk yourself out of it.</p></blockquote><p>When starting your deep learning journey, don&#x27;t try to look for the perfect dataset or the perfect project. Start with a small project that is exciting to you and keep iterating, learning and improving!</p><blockquote><p>...if you take this approach, you will be on your third iteration of learning and improving while the perfectionists are still in the planning stages!</p></blockquote><p>Also, when iterating, ensure that you are spending enough time on all stages of the project - starting from data collection to training your model all the way to deploying your model.</p><blockquote><p>By completing the project end to end, you will see where the trickiest bits are, and which bits make the biggest difference to the final result.</p></blockquote><h2>Humans and Machines</h2><p>Deep learning models are capable of doing some truly amazing things. From classifying images and text, to generating images from captions and vice versa. However, although results of deep learning models might be context-appropriate, there is no guarantee that they will be correct. If you don&#x27;t believe me, take a look at what <a href="https://openai.com/blog/better-language-models/#sample8">this</a> deep learning model has to say about recycling!</p><p>The best way to leverage deep learning is by making it a part of a process in which a human user can interact with it closely. This greatly increases the productivity of human beings, and also eliminates the risk associated with a deep learning model operating on its own in the wild.</p><h2>The Drivetrain Approach</h2><blockquote><p>Many accurate models are of no use to anyone, and many inaccurate models are highly useful.</p></blockquote><ol><li>Consider what your objective is</li><li>Think about what actions you can take to meet that objective (levers)</li><li>Think about what data you have, or can acquire, that can help</li><li>Build a model to determine the best action to take to obtain the best results to meet your objective</li></ol><p>The goal of the Drivetrain Approach is the produce &quot;actionable outcomes&quot; instead of just predictions.</p><h2>Biased Data</h2><p>A model is only as good as the data used to train it. The world is full of biased data so we need to be careful not to let this bias creep in when we are creating our dataset.</p><blockquote><p>Be sure to think carefully about the types of data that you might expect to see in practice in your application, and check carefully to ensure that all these types are reflected in your model&#x27;s source data.</p></blockquote><h2>DataLoaders and DataBlock in Fastai</h2><p>A DataBlock provides a template to create an instance of a DataLoaders object.</p><div><pre class="prism-code language-python" style="color:#393A34;background-color:#f6f8fa;padding:20px"><div class="token-line" style="color:#393A34"><span class="token plain">bears </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> DataBlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        blocks</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ImageBlock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> CategoryBlock</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        get_items</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">get_image_files</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        splitter</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">RandomSplitter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">valid_pct</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> seed</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">42</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        get_y</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">parent_label</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        item_tfms</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Resize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">128</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span></div></pre></div><ul><li><code>ImageBlock</code>: the independent variable in our dataset is going to be images.</li><li><code>CategoryBlock</code>: the dependent variable, i.e. the value we are trying to predict (type of bear) is of a categorical type.</li><li><code>get_items=get_image_files</code>: use the <code>get_image_files</code> function to read images in the file paths that will be given to the DataBlock.</li><li><code>splitter</code>: specify how to split the dataset into train/validation set. We put aside 20% of data in the validation set. The <code>seed</code> property ensures every time we run this piece of code, we get the same train/validation split. This is important for reproducibility.</li><li><code>get_y=parent_label</code>: use the name of the parent folder of each image as the label.</li><li><code>item_tfms=Resize(128)</code>: resize each image to 128 pixels high and wide.</li></ul><p><code>DataLoaders</code> is a thin class that stores instances of DataLoader passed to it.</p><div><pre class="prism-code language-python" style="color:#393A34;background-color:#f6f8fa;padding:20px"><div class="token-line" style="color:#393A34"><span class="token plain">dls </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> bears</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dataloaders</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span></div></pre></div><p>By default, it includes <code>validation</code> and <code>training</code> <code>DataLoader</code> objects.</p><h2>Data Augmentation</h2><p>In practice, when resizing images to a dimension of 128x128, we randomly select a part of the image of that size and crop to that part. On each epoch, a different part of the image is used. This allows the model to learn from different features in the image.</p><p>This kind of augmentation can be achieved using the <code>RandomResizedCrop</code> function:</p><div><pre class="prism-code language-python" style="color:#393A34;background-color:#f6f8fa;padding:20px"><div class="token-line" style="color:#393A34"><span class="token plain">item_tfms</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">RandomResizedCrop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">128</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> min_scale</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span></div></pre></div><p>The <code>min_scale</code> parameter specified how much of the image should be visible at minimum.</p><p>When doing this, the model recognizes each part of the image as a completely new image. As a result, data augmentation allows us to train our model with effectively more samples than we have in our dataset. The model also learns about objects better when it sees them at different positions in an image.</p><p>Other examples of data augmentation that can be used are:</p><ul><li>Rotation</li><li>Flipping</li><li>Perspective warping</li><li>Brightness changes</li><li>Contrast changes</li></ul><h2>Using Your Model to Clean Your Data</h2><p>It is possible to use the predictions a trained model makes to clean the dataset by observing:</p><ol><li>The wrong predictions that the model makes (especially if the model is confident about the incorrect prediction)</li><li>The right predictions that the model makes with very low confidence</li></ol><p>This approach can make it easy to find mislabelled images in the dataset.</p><h2>Avoiding Disaster</h2><p>Examples of other things to consider when using deep learning as a part of a bigger system:</p><ul><li>Managing multiple versions of models</li><li>A/B testing</li><li>Canarying</li><li>Refreshing data (let dataset keep growing vs. delete some old data)</li><li>Data labeling</li><li>Monitoring</li><li>Detecting model rot</li></ul><p>Problems that can occur in production:</p><ul><li><p>Out-of-domain data: data the model sees in production that is very different from what it saw during training. There is no complete technical solution to this problem and it needs to be handled while rolling out the product.</p></li><li><p>Domain shift: data the model sees in production changes over time.</p></li></ul><p>The following deployment process can be used to mitigate the risks:</p><ol><li><p>Manual process: run deep learning model but don&#x27;t use it to drive any actions. Instead, let human beings verify the model predictions and ensure they make sense.</p></li><li><p>Limited scope deployment: use the model with close human supervision for a limited scope (e.g. small geographical area or short period of time)</p></li><li><p>Gradual expansion: steadily increase scope of rollout. Ensure there are reporting systems in place to alert you about significant change in actions being taken compared to manual process used previously. Think about everything that could go wrong, what measure/report can reflect that problem and include it in regular reporting.</p></li></ol><p>Models may change behavior of system they are part of. Using data with bias to train a model may start a positive feedback loop (e.g. predictive policing model used to concentrate policing effort may use past data about police activity that is biased).</p><blockquote><p>&quot;The same technology that&#x27;s the source of so much excitement in my career is being used in law enforcement in ways that could mean that in the coming years, my son, who is 7 now, is more likely to be profiled or arrested - or worse - for no reason other than his race and where we live.&quot;</p></blockquote><p><em>Source: <a href="https://www.nytimes.com/2017/12/02/opinion/sunday/intelligent-policing-and-my-innocent-children.html">https://www.nytimes.com/2017/12/02/opinion/sunday/intelligent-policing-and-my-innocent-children.html</a></em></p></main></div></div></main><footer style="background-color:#6C6C6C;color:#FFF;font-size:12px"><div style="max-width:1100px;min-width:300px;margin:0 auto">Â© <!-- -->2021<!-- --> Ravi Suresh Mashru. All rights reserved.</div></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/2021-06-30-fastbook-ch2/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-2966d4d8fea208fd6f8f.js"],"app":["/app-4bb33029cc1bf54f0b6b.js"],"component---src-components-blog-layout-js":["/component---src-components-blog-layout-js-88c55709438fb4ec120a.js"],"component---src-pages-404-js":["/component---src-pages-404-js-689cfc1b5c0a2e8a2c2e.js"],"component---src-pages-blog-js":["/component---src-pages-blog-js-806e931df0ec1e623367.js"],"component---src-pages-index-js":["/component---src-pages-index-js-c76498f7a9401f0d50d9.js"],"component---src-pages-reading-list-js":["/component---src-pages-reading-list-js-d3c0034680be27e8676e.js"]};/*]]>*/</script><script src="/polyfill-2966d4d8fea208fd6f8f.js" nomodule=""></script><script src="/component---src-components-blog-layout-js-88c55709438fb4ec120a.js" async=""></script><script src="/commons-69d67839b5d44cb35357.js" async=""></script><script src="/styles-e9d24b1846c7d6eb9685.js" async=""></script><script src="/app-4bb33029cc1bf54f0b6b.js" async=""></script><script src="/framework-741ade27086b2708e961.js" async=""></script><script src="/webpack-runtime-67cc6cd1aab21bf7259a.js" async=""></script></body></html>